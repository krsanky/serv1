buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'org.junit.platform:junit-platform-gradle-plugin:1.0.3'
    }
}
plugins {
    id 'gradle-clojure.clojure' version '0.3.1'
}
apply plugin: 'java'
apply plugin: 'org.junit.platform.gradle.plugin'
apply plugin: 'war'
apply plugin: 'idea'

//aotCompile = true // needed for gen-class in servlet.clj

group = 'org.oldcode.javaweb'
version = '0.1.0-SNAPSHOT'
description = 'FIXME: write description'

repositories {
    jcenter()
    maven {
        name = 'clojars'
        url = 'https://clojars.org/repo/'
    }
}

// this doesnt work, at least not in wars where it does.
// (calling clojure from java)
// Maybe because the classnames of mine are not needed at compile time.
// They are brought in at runtime.
sourceSets {
    pre
    main.compileClasspath += pre.output
}

configurations {
    preCompile.extendsFrom compile
}

dependencies {
    //compile 'com.google.googlejavaformat:google-java-format:1.5'
    //compile group: 'org.apache.shiro', name: 'shiro-web', version: '1.4.0'
    compile group: 'org.apache.logging.log4j', name: 'log4j-api', version: '2.10.0'
    compile group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.10.0'

    // put this is manually into tomcat's lib/
    compile group: 'org.postgresql', name: 'postgresql', version: '42.1.4'

    compile group: 'commons-dbutils', name: 'commons-dbutils', version: '1.7'
    compile group: 'org.bouncycastle', name: 'bcprov-jdk15on', version: '1.59'

    compile 'org.clojure:clojure:1.8.0'
    //clojure.tools.namespace
    testCompile group: 'org.clojure', name: 'tools.namespace', version: '0.3.0-alpha4'

    // providedCompile comes from war plugin:
    providedCompile 'javax.servlet:javax.servlet-api:3.1.0' 

    //devCompile 'org.clojure:tools.namespace:0.3.0-alpha4'

    testCompile 'junit:junit:4.12' //clojure uses junit4
    testCompile 'org.junit.jupiter:junit-jupiter-api:5.0.3'
	testRuntime 'org.junit.jupiter:junit-jupiter-engine:5.0.3'
	// To avoid compiler warnings about @API annotations in JUnit code
    testCompileOnly('org.apiguardian:apiguardian-api:1.0.0')

    testCompile "org.mockito:mockito-core:2.+"

    compile "org.bouncycastle:bcprov-jdk15on:1.50"
    compile "com.google.guava:guava:16.0.1"
    compile "org.apache.commons:commons-lang3:3.3.1"
    compile "org.hamcrest:hamcrest-all:1.3"

    compile "org.jooq:jooq:3.10.4"
    compile "org.jooq:jooq-meta:3.10.4"
    compile "org.jooq:jooq-codegen:3.10.4"
}




